title: ms-msdt for RCE (CVE-2022-0438 !?!?)
description: Detecting the execution of weaponized maldoc or embedded link in outlook that uses ms-msdt scheme to execute code.
status: experimental
references:
  - https://twitter.com/nao_sec/status/1530196847679401984
  - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
author: '@Kostastsale'
date: 2022/05/29
logsource:
    category: process_creation
    product: windows
detection:
    selection1:
        ParentImage|endswith:
          - '\excel.exe'
          - '\winword.exe'
          - '\outlook.exe'
        Image|endswith:
          - '\msdt.exe'
        CommandLine|contains|all:
          - 'IT_BrowseForFile'
          - 'IT_LaunchMethod'
    selection2:
        CommandLine|contains:
          - 'ms-msdt:/id'
          - 'ms-msdt:-id'
    condition: selection1 and selection2
falsepositives:
    - Uknown
level: high
tags:
    - attack.execution
    - attack.T1059.003
    - attack.T1204.002
